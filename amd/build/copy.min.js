define(["jquery","core/str","core/notification"],function(e,t,n){return{init:function(){e("#infos").off("click").on("click",function(){if(navigator.clipboard){let e=document.getElementById("serverlabel").innerText,i=document.getElementById("identificationlabel").innerText,o=document.getElementById("ipaddresslabel").innerText.split(" ").slice(-1),l=document.getElementById("configurationlabel").innerText,s=document.getElementById("datelabel").innerText;t.get_string("msgalertgood","block_su_agent_moodle").then(function(t){return navigator.clipboard.writeText(s+" | "+e+" | "+i+" => "+o+" | "+l).then(function(){alert(t)})}).catch(function(){t.get_string("error","block_su_agent_moodle").then(function(e){alert(e)}).fail(n.exception)})}else t.get_string("msgalertbadbrowser","block_su_agent_moodle").then(function(e){alert(e)}).fail(n.exception)}),e("#msgbtn").off("click").on("click",function(){let i=e("#msg").val();if(!i){t.get_string("msgempty","block_su_agent_moodle").then(function(e){alert(e)}).fail(n.exception);return}let o=document.getElementById("serverlabel").innerText,l=document.getElementById("identificationlabel").innerText,s=document.getElementById("ipaddresslabel").innerText,r=document.getElementById("configurationlabel").innerText,a=document.getElementById("datelabel").innerText;e.ajax({url:M.cfg.wwwroot+"/blocks/su_agent_moodle/sendmail.php",method:"POST",data:{message:i,server:o,identification:l,ipaddress:s,configuration:r,date:a,sesskey:M.cfg.sesskey},success:function(i){console.log("R\xe9ponse du serveur :",i),i&&"success"===i.status?t.get_string("msgemailsuccess","block_su_agent_moodle").then(function(t){n.addNotification({message:t,type:"success"}),e("#msg").val("")}).fail(n.exception):t.get_string("msgemailerror","block_su_agent_moodle").then(function(e){n.addNotification({message:e,type:"error"})}).fail(n.exception)},error:function(){t.get_string("msgemailerror","block_su_agent_moodle").then(function(e){n.addNotification({message:e,type:"error"})}).fail(n.exception)}})})}}});
